# PWA Setup - My POS System

## Что уже настроено

✅ Service Worker для офлайн режима
✅ Manifest.json для установки приложения
✅ Meta-теги для мобильных устройств
✅ Поддержка добавления на главный экран

## Иконки приложения

### Создание иконок (нужно сделать один раз)

1. Откройте `/frontend/public/icon.svg` в Figma или любом графическом редакторе
2. Экспортируйте в PNG:
   - `icon-192.png` - 192x192 пикселей
   - `icon-512.png` - 512x512 пикселей
3. Сохраните в папку `/frontend/public/`

**Или используйте онлайн генератор:**
- https://realfavicongenerator.net/
- Загрузите `icon.svg`
- Скачайте сгенерированные иконки

### Временное решение

Пока иконок нет, PWA будет работать, но без красивой иконки при установке.
Браузер использует favicon или первую букву названия.

---

## Как установить на устройства

### Android (Chrome)

1. Откройте сайт в Chrome
2. Нажмите меню (три точки) → "Добавить на главный экран"
3. Введите название (по умолчанию "MyPOS")
4. Готово! Иконка появится на главном экране

### iOS (Safari)

1. Откройте сайт в Safari
2. Нажмите кнопку "Поделиться" (квадрат со стрелкой)
3. Прокрутите вниз → "На экран «Домой»"
4. Введите название → "Добавить"
5. Готово!

### Desktop (Chrome/Edge)

1. Откройте сайт
2. Справа в адресной строке появится иконка установки (+)
3. Нажмите "Установить"
4. Приложение откроется в отдельном окне

---

## Офлайн режим

Service Worker кэширует:
- Основные страницы (/, /pos, /admin, /dashboard)
- CSS и JavaScript
- API запросы (частично)

**Стратегия:** Network First (сначала сеть, потом кэш)
- Если есть интернет → загружает с сервера
- Если нет интернета → показывает из кэша
- Если в кэше нет → показывает главную страницу

### Ограничения офлайн режима (сейчас)

⚠️ API запросы требуют интернета
⚠️ Создание новых заказов требует интернета
✅ Просмотр интерфейса работает офлайн
✅ Навигация между страницами работает офлайн

### Улучшения для Фазы 2

- IndexedDB для локального хранения заказов
- Синхронизация при появлении интернета
- Background Sync API
- Push уведомления

---

## Проверка PWA

### В Chrome DevTools

1. Откройте DevTools (F12)
2. Вкладка "Application"
3. Слева: "Manifest" - проверьте настройки
4. Слева: "Service Workers" - должен быть активен
5. Слева: "Storage" → "Cache Storage" - проверьте кэш

### Lighthouse

1. DevTools → вкладка "Lighthouse"
2. Выберите "Progressive Web App"
3. Нажмите "Analyze page load"
4. Должно быть 80+ баллов

---

## Продакшн деплой

### 1. Build приложения

```bash
cd frontend
npm run build
```

### 2. Хостинг с HTTPS

PWA требует HTTPS! Подойдут:
- Vercel (бесплатно)
- Netlify (бесплатно)
- Railway (платно, но проще)
- Nginx + Let's Encrypt (свой сервер)

### 3. Настройка доменов

Для разных интерфейсов можно использовать:

**Вариант A: Поддомены (рекомендую)**
- `pos.mypos.kz` → Касса
- `admin.mypos.kz` → Админка
- `app.mypos.kz` → Дашборд

**Вариант B: Один домен, разные пути**
- `mypos.kz/pos` → Касса
- `mypos.kz/admin` → Админка
- `mypos.kz/app` → Дашборд

**Как настроить в Vite/React Router:**
Уже настроено! Просто деплойте, и все будет работать.

---

## Обновление приложения

После деплоя новой версии:
1. Service Worker автоматически обновится
2. При следующем открытии - новая версия
3. Можно добавить "Update Available" уведомление

---

## Тестирование

### Локально

```bash
npm run build
npm run preview
```

Откройте в Chrome → DevTools → Application → проверьте Manifest и SW

### На мобильном устройстве

1. Запустите `npm run dev` на компьютере
2. Узнайте IP компьютера в локальной сети (например, 192.168.1.5)
3. Откройте на телефоне: `http://192.168.1.5:5173`
4. Попробуйте добавить на главный экран

---

## Полезные ссылки

- [PWA Guide](https://web.dev/progressive-web-apps/)
- [Service Worker API](https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API)
- [Web App Manifest](https://web.dev/add-manifest/)
